@ECHO OFF
SETLOCAL ENABLEDELAYEDEXPANSION

SET DIRPATH=. 
SET TEMPFILE=%CD%\FILELIST.TXT
GOTO RENAME

:RENAME
ECHO FILE LIST:
DIR %DIRPATH% /O:D /B > CON
DIR %DIRPATH% /O:D /B > %TEMPFILE%
ECHO.
EXIT

FOR /F "TOKENS=*" %%A IN (%TEMPFILE%) DO (
	SET FILENAME=%%A
	SET EXT=%%~xA
	SET MTIME=%%~tA
	SET MTIME=!MTIME: =!
	SET MTIME=!MTIME::=!
	SET MTIME=!MTIME:/=!
	ECHO CURRRENT FILE: !FILENAME!
	ECHO MODIFIED TIME: %%~tA
	SET NEWFILENAME=%DIRPATH%\!MTIME!!EXT!
	ECHO AFTER RENAME: !NEWFILENAME!
	IF EXIST !NEWFILENAME! (
		ECHO FILE EXISTS, SKIP...
	) ELSE (
		MOVE !FILENAME! !NEWFILENAME!
	)
	ECHO.
	PAUSE
)
DEL %TEMPFILE%
ECHO RENAME COMPLETE!
PAUSE