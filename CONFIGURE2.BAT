@ECHO OFF
SETLOCAL ENABLEDELAYEDEXPANSION

REM ##### 確認與修改 ORACLE REGISTRY VALUE #####
ECHO 請確認以下 ORACLE FORMS50_PATH 註冊值
FOR /F "TOKENS=3" %%A IN ('REG QUERY HKLM\SOFTWARE\ORACLE /V FORMS50_PATH') DO SET FORMS50_PATH_OVALUE=%%A
ECHO !FORMS50_PATH_OVALUE!
ECHO.

SET /P CHECK1=是否更改 FORMS50_PATH 註冊值？[Y/N]
IF /I [!CHECK1!] EQU [Y] (
	SET /P CHECK1-1=是否重新輸入 FORMS50_PATH 註冊值？[Y/N]
	IF /I [!CHECK1-1!] EQU [Y] (
		GOTO CHANGE1
	) ELSE (
		GOTO CHANGE1-1
	)
) ELSE (
	GOTO CHECK2
)

:CHECK2
ECHO.
ECHO 請確認以下 ORACLE REPORTS30_PATH 註冊值
FOR /F "TOKENS=3" %%A IN ('REG QUERY HKLM\SOFTWARE\ORACLE /V REPORTS30_PATH') DO SET REPORTS30_PATH_OVALUE=%%A
ECHO !REPORTS30_PATH_OVALUE!
ECHO.

SET /P CHECK2=是否更改 REPORTS30_PATH 註冊值？[Y/N]
IF /I [!CHECK2!] EQU [Y] (
	SET /P CHECK2-1=是否重新輸入 REPORTS30_PATH 註冊值？[Y/N]
	IF /I [!CHECK2-1!] EQU [Y] (
		GOTO CHANGE2
	) ELSE (
		GOTO CHANGE2-1
	)
) ELSE (
	GOTO END
)

:CHANGE1
SET /P FORMS50_PATH_VALUE=請輸入新的 FORMS50_PATH 註冊值: 
REG DELETE HKLM\SOFTWARE\ORACLE /V FORMS50_PATH /F > NUL
REG ADD HKLM\SOFTWARE\ORACLE /V FORMS50_PATH /T REG_EXPAND_SZ /D !FORMS50_PATH_VALUE! > NUL
ECHO FORMS50_PATH 註冊值已經修改完成
GOTO CHECK2

:CHANGE1-1
SET /P FORMS50_PATH_VALUE=請新增 FORMS50_PATH 註冊值: 
REG DELETE HKLM\SOFTWARE\ORACLE /V FORMS50_PATH /F > NUL
REG ADD HKLM\SOFTWARE\ORACLE /V FORMS50_PATH /T REG_EXPAND_SZ /D !FORMS50_PATH_VALUE!!FORMS50_PATH_OVALUE! > NUL
ECHO FORMS50_PATH 註冊值已經修改完成
GOTO CHECK2

:CHANGE2
SET /P REPORTS30_PATH_VALUE=請輸入 REPORTS30_PATH 註冊值: 
REG DELETE HKLM\SOFTWARE\ORACLE /V REPORTS30_PATH /F > NUL
REG ADD HKLM\SOFTWARE\ORACLE /V REPORTS30_PATH /T REG_EXPAND_SZ /D !REPORTS30_PATH_VALUE! > NUL
ECHO REPORTS30_PATH 註冊值已經修改完成
GOTO END

:CHANGE2-1
SET /P REPORTS30_PATH_VALUE=請新增 REPORTS30_PATH 註冊值: 
REG DELETE HKLM\SOFTWARE\ORACLE /V REPORTS30_PATH /F > NUL
REG ADD HKLM\SOFTWARE\ORACLE /V REPORTS30_PATH /T REG_EXPAND_SZ /D !REPORTS30_PATH_VALUE!!REPORTS30_PATH_OVALUE! > NUL
ECHO REPORTS30_PATH 註冊值已經修改完成
GOTO END

:END
ECHO.
ECHO 所有設定已經完成
PAUSE